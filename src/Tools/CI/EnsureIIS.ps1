param([String]$websiteName, [String]$websitePath, [int16]$websitePort)

Import-Module -Name WebAdministration
$website = Get-Website -Name $websiteName

if (!$website) { 
    Write-Host "Creating website";
    $poolName = $websiteName + "Pool";
    
    ##create directory
    $testDir = (Test-Path C:\www\selenium.utils.tests -PathType Container);
    if($testDir.ToString() -eq "False"){
        mkdir $websitePath;
    }
    try{
        New-WebAppPool -Name $poolName;
    }
    Catch{

    }
    New-Website -Name $websiteName -ApplicationPool $poolName -PhysicalPath $websitePath -Port $websitePort
    

} else {
    Write-Host "Website already exists."

}

# SIG # Begin signature block
# MIINigYJKoZIhvcNAQcCoIINezCCDXcCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQU4s++ibgN7f0L4TOT2WludiN/
# 8/SgggrJMIIE3TCCA8WgAwIBAgIQUiqaUGMJaEau8XEUJgs+RjANBgkqhkiG9w0B
# AQsFADB1MQswCQYDVQQGEwJJTDEWMBQGA1UEChMNU3RhcnRDb20gTHRkLjEpMCcG
# A1UECxMgU3RhcnRDb20gQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxIzAhBgNVBAMT
# GlN0YXJ0Q29tIENsYXNzIDMgT2JqZWN0IENBMB4XDTE2MDcyMTEzMzg1NFoXDTE5
# MDcyMTEzMzg1NFowajELMAkGA1UEBhMCQ1oxDjAMBgNVBAgMBVByYWhhMRkwFwYD
# VQQHDBBQcmFoYSA5LVZ5c29jYW55MRcwFQYDVQQKDA5SSUdBTlRJIHMuci5vLjEX
# MBUGA1UEAwwOUklHQU5USSBzLnIuby4wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw
# ggEKAoIBAQDwcmqGGFtawI13vikJ5T9B7IGy5xbRzYtrDcHKmmLS6/boHLtWvaCb
# 6VxrkkbVsyhHQ5ILly4zGBmWXLlE8K7nxub7sEutYi+Rm7EVj5YlZ/ulnGJhYmzC
# hOI3NR3wl+sjcjcigtJOZbZ1S5CMOYDHx8hMonMubrVfDIerVLFjGjucc6kLx1tf
# aAmORSgVEs8Wl22OASEtbRu3sK8D1qDl+niGNCvciKzHlF4nf5T9lSlInV60C5Vm
# aGzxUVqBmm7GlOOL/A/sgSahino4L7dUtpZCIy87BWaX1Pz0dfpbe/Z6y2SjoNpQ
# d1xzyDInvl9qRdapJsRUyt2WWhWINZQlAgMBAAGjggFyMIIBbjAOBgNVHQ8BAf8E
# BAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwMwCQYDVR0TBAIwADAdBgNVHQ4EFgQU
# EbnvraS0IisWvTASdLhnZrvkHEQwbQYIKwYBBQUHAQEEYTBfMCQGCCsGAQUFBzAB
# hhhodHRwOi8vb2NzcC5zdGFydHNzbC5jb20wNwYIKwYBBQUHMAKGK2h0dHA6Ly9h
# aWEuc3RhcnRzc2wuY29tL2NlcnRzL3NjYS5jb2RlMy5jcnQwNgYDVR0fBC8wLTAr
# oCmgJ4YlaHR0cDovL2NybC5zdGFydHNzbC5jb20vc2NhLWNvZGUzLmNybDAjBgNV
# HRIEHDAahhhodHRwOi8vd3d3LnN0YXJ0c3NsLmNvbS8wUQYDVR0gBEowSDAIBgZn
# gQwBBAEwPAYLKwYBBAGBtTcBAgUwLTArBggrBgEFBQcCARYfaHR0cHM6Ly93d3cu
# c3RhcnRzc2wuY29tL3BvbGljeTANBgkqhkiG9w0BAQsFAAOCAQEAf5NNYdzZdHIU
# UHuJrNW3noB5h10P5vTJQKwgD/G5j2utpEm0bhQNjqmGALhrXCA75Nne8VZVUiQo
# YiWVjIcvxHEZ30ypN5NWCITa0yXKI9JzVpmvaawt+ExsGAaRvnpxTElb1gk7v+7J
# w/W5SKYQIU1sN6abihraeUBvcohgYR3wmrxs+3EDkAsfDDL1YJeFPLiBEzPVSjUw
# +SGymrAJM4EbSEcUIvyJx91WlDrwBR5fwohck+4WKa2iv7Rk/Dm/ysaUpUHDC0IV
# hCE8xWtqnUbLDwe307kClj4tpJn5Zrp/YncVyR8ZumCZFoaOQgTrw34B5Z4mILYb
# 8act2oV+ATCCBeQwggPMoAMCAQICEHgiQ6FT3ygKH/rhXNAoTIYwDQYJKoZIhvcN
# AQELBQAwfTELMAkGA1UEBhMCSUwxFjAUBgNVBAoTDVN0YXJ0Q29tIEx0ZC4xKzAp
# BgNVBAsTIlNlY3VyZSBEaWdpdGFsIENlcnRpZmljYXRlIFNpZ25pbmcxKTAnBgNV
# BAMTIFN0YXJ0Q29tIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MB4XDTE1MTIxNjAx
# MDAwNVoXDTMwMTIxNjAxMDAwNVowdTELMAkGA1UEBhMCSUwxFjAUBgNVBAoTDVN0
# YXJ0Q29tIEx0ZC4xKTAnBgNVBAsTIFN0YXJ0Q29tIENlcnRpZmljYXRpb24gQXV0
# aG9yaXR5MSMwIQYDVQQDExpTdGFydENvbSBDbGFzcyAzIE9iamVjdCBDQTCCASIw
# DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANhsJTYUZFx5zWGYAp8FlVG8yEBm
# yldXMpNloFW7wnrfr/7lVSgyZ+ZjL8LvZcDB5nftTaSlvd5MCOJW9WlMICRksLS/
# 2vo5b/BsOjIs5A9j8FSt0far4mtE0dlu5mQ3+6hbn2tgjW+m6aksqDymsAIAAW/N
# FKCsyrDlqNOaujXkfmdpbe0keZqKfDDw7DoHZygP9e6KaDn0pcuheiYNa+T+cqlr
# V8Tw3sZmzPyxv/itSCiR3G+yo9LKDZwVFfRj/tpAJhFAodHEw9Swna2FRYlpA1TZ
# g93QSEDeu6HjTR9AJPHA4I4SRhsIL5LuGWVhuxT1hX2pLmKSL2mPACV3etcCAwEA
# AaOCAWYwggFiMA4GA1UdDwEB/wQEAwIBBjAfBgNVHSUEGDAWBggrBgEFBQcDAwYK
# KwYBBAGCNz0BATASBgNVHRMBAf8ECDAGAQH/AgEAMDIGA1UdHwQrMCkwJ6AloCOG
# IWh0dHA6Ly9jcmwuc3RhcnRzc2wuY29tL3Nmc2NhLmNybDBmBggrBgEFBQcBAQRa
# MFgwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLnN0YXJ0c3NsLmNvbTAwBggrBgEF
# BQcwAoYkaHR0cDovL2FpYS5zdGFydHNzbC5jb20vY2VydHMvY2EuY3J0MB0GA1Ud
# DgQWBBRmep7NnHOGammgrvqMuxiPCOzVBDAfBgNVHSMEGDAWgBROC+8apEBbpRdp
# hzDKNGhD0EGu8jA/BgNVHSAEODA2MDQGBFUdIAAwLDAqBggrBgEFBQcCARYeaHR0
# cDovL3d3dy5zdGFydHNzbC5jb20vcG9saWN5MA0GCSqGSIb3DQEBCwUAA4ICAQAL
# H3fwpLbmkgX1R/F0c6VgGrehmK66gJnxuJbU+iPpymMFgggAr5TMITlT1VGYaAHA
# 4PZTvlgRmL3ZrhHnn+/TI03MZyt4XluVm0qju0w0R+EpeUZHycXTKK51G8Jjvfn9
# u1GnsgKTQFNeep1p+f40LvQai2wLQgCJ4ScvqIUK5+2FJvS4yNOugZejNyw45duX
# UyWukBahG2fQFcW6yZuvjHHh7qfAi2Dyv1w6FeJeHNP/tPhYdQK6bRKDM//EDFyX
# Y/+xEWaBREDDI8D2HJVvJ8p0AIZQatPNBiF7AdiPSZVBYwhXBr9n7NwOrFkqARvH
# mecrdQ1hIwSMUtIuvHtRUJKin6J4dJWDnvO3llnKrhHYnpu4SgzC6Dk2KGbppnba
# xP8x4rJdjWkkiltYfYuv0oy8UjEPHZAvlqhGmnc2q5kvVc0NtXgD5IipE8xybXrI
# 9nd5uErPhR4eSvguRy5aNusuF//bdcB9lGhMM3V2QyLRgABXh34TwfBVSvLrnwTh
# qC06t66niXyxqA/98iad8PdAHfSkyRBMMNxk0LVSETfJ/FtVJr6JvWPfQgRxek+L
# 8s6sw/bb4Jr6LnCCQjaChoDFrn0CevRgDsodMJbbFPToTJk8sgOOK1D3mWOAhLL1
# G765DD80ytzX/aOOXA5wfpQTTzIb/6SPXHX1nKRYyTGCAiswggInAgEBMIGJMHUx
# CzAJBgNVBAYTAklMMRYwFAYDVQQKEw1TdGFydENvbSBMdGQuMSkwJwYDVQQLEyBT
# dGFydENvbSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEjMCEGA1UEAxMaU3RhcnRD
# b20gQ2xhc3MgMyBPYmplY3QgQ0ECEFIqmlBjCWhGrvFxFCYLPkYwCQYFKw4DAhoF
# AKB4MBgGCisGAQQBgjcCAQwxCjAIoAKAAKECgAAwGQYJKoZIhvcNAQkDMQwGCisG
# AQQBgjcCAQQwHAYKKwYBBAGCNwIBCzEOMAwGCisGAQQBgjcCARUwIwYJKoZIhvcN
# AQkEMRYEFP9P/scXJA6KxXUdjVSWPIpUNGvAMA0GCSqGSIb3DQEBAQUABIIBAKoZ
# af+72LAWHkVfzM7l32LP8XHzhMZ7AU2VBhP84MBvlZzsQS530LujGsg8t0M7XJVt
# cuQhkDZ7cPzExbnxu8AfRzPaDU5HturIxJLFXRoSu4+/q+jLPM6yGShuEQvwQngV
# zqbojiGb1p8kRMRl+OGToWq5iF74BKUEc00P2e/d6yoSGRUPsJO0TQszq2nlJaqW
# 07xP3R6EKRsSn/xDJedgSKWj6koebn2jFZDFTrHbuYGdQMt9BqG0i7PdDR58Y/0n
# NmWbgPGjxhxRkMUe1k+hqByGcczu3x9o2Cm6CT662BOMxGdsHcS4Hk1B/Fy4k8je
# 1bYdxJ6GOQ6jeboB+FY=
# SIG # End signature block
